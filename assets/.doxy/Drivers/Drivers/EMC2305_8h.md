

# File EMC2305.h



[**FileList**](files.md) **>** [**driver**](dir_1284b95147afa48b330f502c8bbc0529.md) **>** [**Inc**](dir_63ffe06a04b97e03324a2ad2f10a5002.md) **>** [**EMC2305.h**](EMC2305_8h.md)

[Go to the source code of this file](EMC2305_8h_source.md)



* `#include <stdint.h>`
* `#include "stm32xx_hal.h"`
* `#include "FreeRTOS.h"`















## Classes

| Type | Name |
| ---: | :--- |
| struct | [**EMC2305\_Fan\_Config1**](structEMC2305__Fan__Config1.md) <br> |
| struct | [**EMC2305\_Fan\_Config2**](structEMC2305__Fan__Config2.md) <br> |
| struct | [**EMC2305\_Fan\_Status**](structEMC2305__Fan__Status.md) <br> |
| struct | [**EMC2305\_Global\_Config**](structEMC2305__Global__Config.md) <br> |
| struct | [**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) <br> |
| struct | [**EMC2305\_I2C\_Message**](structEMC2305__I2C__Message.md) <br> |


## Public Types

| Type | Name |
| ---: | :--- |
| enum  | [**EMC2305\_DPT**](#enum-emc2305_dpt)  <br> |
| enum  | [**EMC2305\_EDG**](#enum-emc2305_edg)  <br> |
| enum  | [**EMC2305\_ERG**](#enum-emc2305_erg)  <br> |
| enum  | [**EMC2305\_Fan**](#enum-emc2305_fan)  <br> |
| enum  | [**EMC2305\_I2C\_OP**](#enum-emc2305_i2c_op)  <br> |
| enum  | [**EMC2305\_PID\_Gain**](#enum-emc2305_pid_gain)  <br> |
| enum  | [**EMC2305\_PWM\_BaseFreq**](#enum-emc2305_pwm_basefreq)  <br> |
| enum  | [**EMC2305\_RNG**](#enum-emc2305_rng)  <br> |
| enum  | [**EMC2305\_Status**](#enum-emc2305_status)  <br> |
| enum  | [**EMC2305\_UDT**](#enum-emc2305_udt)  <br> |




















## Public Functions

| Type | Name |
| ---: | :--- |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_EnableSWLock**](#function-emc2305_enableswlock) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip) <br>_Software locks all SWL registers. SWL registers are now read-only until power cycle._  |
|  uint8\_t | [**EMC2305\_GetFanPWM**](#function-emc2305_getfanpwm) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan) <br>_Gets current fan driver PWM duty cycle._  |
|  uint16\_t | [**EMC2305\_GetFanRPM**](#function-emc2305_getfanrpm) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan) <br>_Gets current fan RPM based on tachometer measurement._  |
|  [**EMC2305\_Fan\_Status**](structEMC2305__Fan__Status.md) | [**EMC2305\_GetFanStatus**](#function-emc2305_getfanstatus) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip) <br>_Gets current fan status for all drivers._  |
|  void | [**EMC2305\_I2C\_MasterRxCpltCallback**](#function-emc2305_i2c_masterrxcpltcallback) (I2C\_HandleTypeDef \* hi2c) <br> |
|  void | [**EMC2305\_I2C\_MasterTxCpltCallback**](#function-emc2305_i2c_mastertxcpltcallback) (I2C\_HandleTypeDef \* hi2c) <br> |
|  void | [**EMC2305\_I2C\_Worker\_Task**](#function-emc2305_i2c_worker_task) (void \* pvParameters) <br> |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_Init**](#function-emc2305_init) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, I2C\_HandleTypeDef \* hi2c, uint16\_t dev\_addr) <br>_Initializes the I2C bus and validates the chip by reading the Product ID and Manufacturer ID._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_ReadReg**](#function-emc2305_readreg) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, uint8\_t reg, uint8\_t \* data) <br>_Reads a byte of data from the specified register._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetFanConfig**](#function-emc2305_setfanconfig) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan, [**EMC2305\_Fan\_Config1**](structEMC2305__Fan__Config1.md) \* config1, [**EMC2305\_Fan\_Config2**](structEMC2305__Fan__Config2.md) \* config2) <br>_Sets the EMC2305 configuration 1 and 2 registers based on the provided config._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetFanPWM**](#function-emc2305_setfanpwm) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan, uint8\_t duty\_cycle) <br>_Sets the PWM drive of the specified fan directly. Works only with fan speed control (FSC) disabled._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetFanRPM**](#function-emc2305_setfanrpm) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan, uint16\_t rpm\_target) <br>_Sets the RPM target for the control algorithm. Works only with fan speed control (FSC) enabled._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetGlobalConfig**](#function-emc2305_setglobalconfig) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Global\_Config**](structEMC2305__Global__Config.md) \* config) <br>_Sets the EMC2305 global configuration register based on provided config._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetPWMBaseFrequency**](#function-emc2305_setpwmbasefrequency) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan, [**EMC2305\_PWM\_BaseFreq**](EMC2305_8h.md#enum-emc2305_pwm_basefreq) freq) <br>_Sets the base frequency of the specified fan's PWM driver._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_SetPWMOutputMode**](#function-emc2305_setpwmoutputmode) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, [**EMC2305\_Fan**](EMC2305_8h.md#enum-emc2305_fan) fan, bool open\_drain) <br>_Sets the specified fan's PWM driver to open-drain or push-pull._  |
|  [**EMC2305\_Status**](EMC2305_8h.md#enum-emc2305_status) | [**EMC2305\_WriteReg**](#function-emc2305_writereg) ([**EMC2305\_HandleTypeDef**](structEMC2305__HandleTypeDef.md) \* chip, uint8\_t reg, uint8\_t data) <br>_Writes a byte of data to the specified register._  |



























## Macros

| Type | Name |
| ---: | :--- |
| define  | [**EMC2305\_CFG\_DIS\_TO**](EMC2305_8h.md#define-emc2305_cfg_dis_to)  `(1u &lt;&lt; 6)  /\* DIS\_TO - SMBus timeout disable (I2C compat) \*/`<br> |
| define  | [**EMC2305\_CFG\_DRECK**](EMC2305_8h.md#define-emc2305_cfg_dreck)  `(1u &lt;&lt; 1)  /\* DRECK - CLK pin drives internal clock when set (output) \*/`<br> |
| define  | [**EMC2305\_CFG\_MASK\_ALERT**](EMC2305_8h.md#define-emc2305_cfg_mask_alert)  `(1u &lt;&lt; 7)  /\* MASK - mask ALERT pin when set \*/`<br> |
| define  | [**EMC2305\_CFG\_USECK**](EMC2305_8h.md#define-emc2305_cfg_useck)  `(1u &lt;&lt; 0)  /\* USECK - use external CLK pin as tach clock when set \*/`<br> |
| define  | [**EMC2305\_CFG\_WD\_EN**](EMC2305_8h.md#define-emc2305_cfg_wd_en)  `(1u &lt;&lt; 5)  /\* WD\_EN - enable watchdog continuous mode \*/`<br> |
| define  | [**EMC2305\_CONFIG1\_EDG\_SHIFT**](EMC2305_8h.md#define-emc2305_config1_edg_shift)  `3u`<br> |
| define  | [**EMC2305\_CONFIG1\_ENAG\_SHIFT**](EMC2305_8h.md#define-emc2305_config1_enag_shift)  `7u`<br> |
| define  | [**EMC2305\_CONFIG1\_RNG\_SHIFT**](EMC2305_8h.md#define-emc2305_config1_rng_shift)  `5u`<br> |
| define  | [**EMC2305\_CONFIG1\_UDT\_SHIFT**](EMC2305_8h.md#define-emc2305_config1_udt_shift)  `0u`<br> |
| define  | [**EMC2305\_CONFIG2\_DPT\_SHIFT**](EMC2305_8h.md#define-emc2305_config2_dpt_shift)  `3u`<br> |
| define  | [**EMC2305\_CONFIG2\_ENRC\_SHIFT**](EMC2305_8h.md#define-emc2305_config2_enrc_shift)  `6u`<br> |
| define  | [**EMC2305\_CONFIG2\_ERG\_SHIFT**](EMC2305_8h.md#define-emc2305_config2_erg_shift)  `1u`<br> |
| define  | [**EMC2305\_CONFIG2\_GHEN\_SHIFT**](EMC2305_8h.md#define-emc2305_config2_ghen_shift)  `5u`<br> |
| define  | [**EMC2305\_FAN1\_MASK**](EMC2305_8h.md#define-emc2305_fan1_mask)  `(1u &lt;&lt; 0)`<br> |
| define  | [**EMC2305\_FAN2\_MASK**](EMC2305_8h.md#define-emc2305_fan2_mask)  `(1u &lt;&lt; 1)`<br> |
| define  | [**EMC2305\_FAN3\_MASK**](EMC2305_8h.md#define-emc2305_fan3_mask)  `(1u &lt;&lt; 2)`<br> |
| define  | [**EMC2305\_FAN4\_MASK**](EMC2305_8h.md#define-emc2305_fan4_mask)  `(1u &lt;&lt; 3)`<br> |
| define  | [**EMC2305\_FAN5\_MASK**](EMC2305_8h.md#define-emc2305_fan5_mask)  `(1u &lt;&lt; 4)`<br> |
| define  | [**EMC2305\_FAN\_ADDRESS\_OFFSET**](EMC2305_8h.md#define-emc2305_fan_address_offset)  `0x10u`<br> |
| define  | [**EMC2305\_FAN\_REG\_ADDR**](EMC2305_8h.md#define-emc2305_fan_reg_addr) (fan\_num, fan1\_reg\_addr) `((fan1\_reg\_addr) + ((fan\_num) \* [**EMC2305\_FAN\_ADDRESS\_OFFSET**](EMC2305_8h.md#define-emc2305_fan_address_offset)))`<br>_Calculates the register address for a specific fan (N) based on the Fan 1 register address and known offset._  |
| define  | [**EMC2305\_I2C\_TIMEOUT**](EMC2305_8h.md#define-emc2305_i2c_timeout)  `100u`<br> |
| define  | [**EMC2305\_INVALID\_FAN**](EMC2305_8h.md#define-emc2305_invalid_fan) (fan\_num) `(fan &lt; EMC2305\_FAN1 \|\| fan &gt; EMC2305\_FAN5)`<br> |
| define  | [**EMC2305\_MAX\_RPM**](EMC2305_8h.md#define-emc2305_max_rpm)  `16000`<br> |
| define  | [**EMC2305\_MIN\_RPM**](EMC2305_8h.md#define-emc2305_min_rpm)  `500`<br> |
| define  | [**EMC2305\_PWM\_FAN1\_MASK**](EMC2305_8h.md#define-emc2305_pwm_fan1_mask)  `0x03u`<br> |
| define  | [**EMC2305\_PWM\_FAN1\_SHIFT**](EMC2305_8h.md#define-emc2305_pwm_fan1_shift)  `0u`<br> |
| define  | [**EMC2305\_PWM\_FAN2\_MASK**](EMC2305_8h.md#define-emc2305_pwm_fan2_mask)  `0x0Cu`<br> |
| define  | [**EMC2305\_PWM\_FAN2\_SHIFT**](EMC2305_8h.md#define-emc2305_pwm_fan2_shift)  `2u`<br> |
| define  | [**EMC2305\_PWM\_FAN3\_MASK**](EMC2305_8h.md#define-emc2305_pwm_fan3_mask)  `0x30u`<br> |
| define  | [**EMC2305\_PWM\_FAN3\_SHIFT**](EMC2305_8h.md#define-emc2305_pwm_fan3_shift)  `4u`<br> |
| define  | [**EMC2305\_PWM\_FAN4\_MASK**](EMC2305_8h.md#define-emc2305_pwm_fan4_mask)  `0x03u`<br> |
| define  | [**EMC2305\_PWM\_FAN4\_SHIFT**](EMC2305_8h.md#define-emc2305_pwm_fan4_shift)  `0u`<br> |
| define  | [**EMC2305\_PWM\_FAN5\_MASK**](EMC2305_8h.md#define-emc2305_pwm_fan5_mask)  `0x0Cu`<br> |
| define  | [**EMC2305\_PWM\_FAN5\_SHIFT**](EMC2305_8h.md#define-emc2305_pwm_fan5_shift)  `2u`<br> |
| define  | [**EMC2305\_QUEUE\_ITEM\_SIZE**](EMC2305_8h.md#define-emc2305_queue_item_size)  `sizeof([**EMC2305\_I2C\_Message**](structEMC2305__I2C__Message.md))`<br> |
| define  | [**EMC2305\_QUEUE\_LENGTH**](EMC2305_8h.md#define-emc2305_queue_length)  `10`<br> |
| define  | [**EMC2305\_REG\_CONFIGURATION**](EMC2305_8h.md#define-emc2305_reg_configuration)  `0x20u`<br> |
| define  | [**EMC2305\_REG\_DRIVE\_FAIL\_STATUS**](EMC2305_8h.md#define-emc2305_reg_drive_fail_status)  `0x27u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_CONFIG1**](EMC2305_8h.md#define-emc2305_reg_fan1_config1)  `0x32u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_CONFIG2**](EMC2305_8h.md#define-emc2305_reg_fan1_config2)  `0x33u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_DRVFAIL\_H**](EMC2305_8h.md#define-emc2305_reg_fan1_drvfail_h)  `0x3Bu`<br> |
| define  | [**EMC2305\_REG\_FAN1\_DRVFAIL\_L**](EMC2305_8h.md#define-emc2305_reg_fan1_drvfail_l)  `0x3Au`<br> |
| define  | [**EMC2305\_REG\_FAN1\_MAX\_STEP**](EMC2305_8h.md#define-emc2305_reg_fan1_max_step)  `0x37u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_MIN\_DRIVE**](EMC2305_8h.md#define-emc2305_reg_fan1_min_drive)  `0x38u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_SETTING**](EMC2305_8h.md#define-emc2305_reg_fan1_setting)  `0x30u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_SPIN**](EMC2305_8h.md#define-emc2305_reg_fan1_spin)  `0x36u`<br> |
| define  | [**EMC2305\_REG\_FAN1\_TACH\_READING\_H**](EMC2305_8h.md#define-emc2305_reg_fan1_tach_reading_h)  `0x3Eu`<br> |
| define  | [**EMC2305\_REG\_FAN1\_TACH\_READING\_L**](EMC2305_8h.md#define-emc2305_reg_fan1_tach_reading_l)  `0x3Fu`<br> |
| define  | [**EMC2305\_REG\_FAN1\_TACH\_TARGET\_H**](EMC2305_8h.md#define-emc2305_reg_fan1_tach_target_h)  `0x3Du`<br> |
| define  | [**EMC2305\_REG\_FAN1\_TACH\_TARGET\_L**](EMC2305_8h.md#define-emc2305_reg_fan1_tach_target_l)  `0x3Cu`<br> |
| define  | [**EMC2305\_REG\_FAN1\_VALID\_TACH**](EMC2305_8h.md#define-emc2305_reg_fan1_valid_tach)  `0x39u`<br> |
| define  | [**EMC2305\_REG\_FAN\_INTERRUPT\_ENABLE**](EMC2305_8h.md#define-emc2305_reg_fan_interrupt_enable)  `0x29u`<br> |
| define  | [**EMC2305\_REG\_FAN\_SPIN\_STATUS**](EMC2305_8h.md#define-emc2305_reg_fan_spin_status)  `0x26u`<br> |
| define  | [**EMC2305\_REG\_FAN\_STALL\_STATUS**](EMC2305_8h.md#define-emc2305_reg_fan_stall_status)  `0x25u`<br> |
| define  | [**EMC2305\_REG\_FAN\_STATUS**](EMC2305_8h.md#define-emc2305_reg_fan_status)  `0x24u`<br> |
| define  | [**EMC2305\_REG\_GAIN1**](EMC2305_8h.md#define-emc2305_reg_gain1)  `0x35u`<br> |
| define  | [**EMC2305\_REG\_MANUFACTURER\_ID**](EMC2305_8h.md#define-emc2305_reg_manufacturer_id)  `0xFEu`<br> |
| define  | [**EMC2305\_REG\_PRODUCT\_FEAT**](EMC2305_8h.md#define-emc2305_reg_product_feat)  `0xFCu`<br> |
| define  | [**EMC2305\_REG\_PRODUCT\_ID**](EMC2305_8h.md#define-emc2305_reg_product_id)  `0xFDu`<br> |
| define  | [**EMC2305\_REG\_PWM1\_DIVIDE**](EMC2305_8h.md#define-emc2305_reg_pwm1_divide)  `0x31u`<br> |
| define  | [**EMC2305\_REG\_PWM\_BASEF123**](EMC2305_8h.md#define-emc2305_reg_pwm_basef123)  `0x2Du`<br> |
| define  | [**EMC2305\_REG\_PWM\_BASEF45**](EMC2305_8h.md#define-emc2305_reg_pwm_basef45)  `0x2Cu`<br> |
| define  | [**EMC2305\_REG\_PWM\_OUTPUT\_CONFIG**](EMC2305_8h.md#define-emc2305_reg_pwm_output_config)  `0x2Bu`<br> |
| define  | [**EMC2305\_REG\_PWM\_POLARITY**](EMC2305_8h.md#define-emc2305_reg_pwm_polarity)  `0x2Au`<br> |
| define  | [**EMC2305\_REG\_REVISION**](EMC2305_8h.md#define-emc2305_reg_revision)  `0xFFu`<br> |
| define  | [**EMC2305\_REG\_SW\_LOCK**](EMC2305_8h.md#define-emc2305_reg_sw_lock)  `0xEFu`<br> |
| define  | [**EMC2305\_SEMAPHORE\_POOL\_SIZE**](EMC2305_8h.md#define-emc2305_semaphore_pool_size)  `[**EMC2305\_QUEUE\_LENGTH**](EMC2305_8h.md#define-emc2305_queue_length)`<br> |
| define  | [**EMC2305\_STAT\_DRVFAIL**](EMC2305_8h.md#define-emc2305_stat_drvfail)  `(1u &lt;&lt; 2)  /\* Drive fail summary \*/`<br> |
| define  | [**EMC2305\_STAT\_FNSPIN**](EMC2305_8h.md#define-emc2305_stat_fnspin)  `(1u &lt;&lt; 1)  /\* spin-up failure summary \*/`<br> |
| define  | [**EMC2305\_STAT\_FNSTL**](EMC2305_8h.md#define-emc2305_stat_fnstl)  `(1u &lt;&lt; 0)  /\* stall summary \*/`<br> |
| define  | [**EMC2305\_STAT\_WATCH**](EMC2305_8h.md#define-emc2305_stat_watch)  `(1u &lt;&lt; 7)  /\* WATCH - watchdog fired (read-to-clear) \*/`<br> |
| define  | [**EMC2305\_SWL**](EMC2305_8h.md#define-emc2305_swl)  `(1u &lt;&lt; 0)`<br> |
| define  | [**EMC2305\_TACH\_MULT**](EMC2305_8h.md#define-emc2305_tach_mult)  `2u`<br> |
| define  | [**EMC2305\_TACH\_RPM\_CONV**](EMC2305_8h.md#define-emc2305_tach_rpm_conv)  `3932160u`<br> |

## Public Types Documentation




### enum EMC2305\_DPT 

```C++
enum EMC2305_DPT {
    EMC2305_DPT_NONE = 0b00,
    EMC2305_DPT_BASIC = 0b01,
    EMC2305_DPT_STEP = 0b10,
    EMC2305_DPT_BOTH = 0b11
};
```




<hr>



### enum EMC2305\_EDG 

```C++
enum EMC2305_EDG {
    EMC2305_EDG_9 = 0b11,
    EMC2305_EDG_7 = 0b10,
    EMC2305_EDG_5 = 0b01,
    EMC2305_EDG_3 = 0b00
};
```




<hr>



### enum EMC2305\_ERG 

```C++
enum EMC2305_ERG {
    EMC2305_ERG_0RPM = 0b00,
    EMC2305_ERG_50RPM = 0b01,
    EMC2305_ERG_100RPM = 0b10,
    EMC2305_ERG_200RPM = 0b11
};
```




<hr>



### enum EMC2305\_Fan 

```C++
enum EMC2305_Fan {
    EMC2305_FAN1,
    EMC2305_FAN2,
    EMC2305_FAN3,
    EMC2305_FAN4,
    EMC2305_FAN5
};
```




<hr>



### enum EMC2305\_I2C\_OP 

```C++
enum EMC2305_I2C_OP {
    EMC2305_OP_WRITE,
    EMC2305_OP_READ
};
```




<hr>



### enum EMC2305\_PID\_Gain 

```C++
enum EMC2305_PID_Gain {
    EMC2305_PID_8X = 0b11,
    EMC2305_PID_4X = 0b10,
    EMC2305_PID_2X = 0b01,
    EMC2305_PID_1X = 0b00
};
```




<hr>



### enum EMC2305\_PWM\_BaseFreq 

```C++
enum EMC2305_PWM_BaseFreq {
    EMC2305_PWM_2k441 = 0b11,
    EMC2305_PWM_4k882 = 0b10,
    EMC2305_PWM_19k53 = 0b01,
    EMC2305_PWM_26k00 = 0b00
};
```




<hr>



### enum EMC2305\_RNG 

```C++
enum EMC2305_RNG {
    EMC2305_RNG_4000 = 0b11,
    EMC2305_RNG_2000 = 0b10,
    EMC2305_RNG_1000 = 0b01,
    EMC2305_RNG_500 = 0b00
};
```




<hr>



### enum EMC2305\_Status 

```C++
enum EMC2305_Status {
    EMC2305_OK,
    EMC2305_ERR
};
```




<hr>



### enum EMC2305\_UDT 

```C++
enum EMC2305_UDT {
    EMC2305_UDT_100 = 0b000,
    EMC2305_UDT_200 = 0b001,
    EMC2305_UDT_300 = 0b010,
    EMC2305_UDT_400 = 0b011,
    EMC2305_UDT_500 = 0b100,
    EMC2305_UDT_800 = 0b101,
    EMC2305_UDT_1200 = 0b110,
    EMC2305_UDT_1600 = 0b111
};
```




<hr>
## Public Functions Documentation




### function EMC2305\_EnableSWLock 

_Software locks all SWL registers. SWL registers are now read-only until power cycle._ 
```C++
EMC2305_Status EMC2305_EnableSWLock (
    EMC2305_HandleTypeDef * chip
) 
```





**Parameters:**


* `chip` EMC2305 to lock 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_GetFanPWM 

_Gets current fan driver PWM duty cycle._ 
```C++
uint8_t EMC2305_GetFanPWM (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan
) 
```





**Parameters:**


* `chip` EMC2305 to get 
* `fan` Fan to get (1-5) 



**Returns:**

Driven fan PWM duty cycle (0-100). UINT8\_MAX on error 





        

<hr>



### function EMC2305\_GetFanRPM 

_Gets current fan RPM based on tachometer measurement._ 
```C++
uint16_t EMC2305_GetFanRPM (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan
) 
```





**Parameters:**


* `chip` EMC2305 to get 
* `fan` Fan to get (1-5) 



**Returns:**

Measured fan RPM. UINT16\_MAX on error 





        

<hr>



### function EMC2305\_GetFanStatus 

_Gets current fan status for all drivers._ 
```C++
EMC2305_Fan_Status EMC2305_GetFanStatus (
    EMC2305_HandleTypeDef * chip
) 
```





**Parameters:**


* `chip` EMC2305 to get 



**Returns:**

Fan status for all drivers 





        

<hr>



### function EMC2305\_I2C\_MasterRxCpltCallback 

```C++
void EMC2305_I2C_MasterRxCpltCallback (
    I2C_HandleTypeDef * hi2c
) 
```




<hr>



### function EMC2305\_I2C\_MasterTxCpltCallback 

```C++
void EMC2305_I2C_MasterTxCpltCallback (
    I2C_HandleTypeDef * hi2c
) 
```




<hr>



### function EMC2305\_I2C\_Worker\_Task 

```C++
void EMC2305_I2C_Worker_Task (
    void * pvParameters
) 
```




<hr>



### function EMC2305\_Init 

_Initializes the I2C bus and validates the chip by reading the Product ID and Manufacturer ID._ 
```C++
EMC2305_Status EMC2305_Init (
    EMC2305_HandleTypeDef * chip,
    I2C_HandleTypeDef * hi2c,
    uint16_t dev_addr
) 
```





**Parameters:**


* `chip` EMC2305 to initialize 
* `hi2c` STM32 HAL I2C handle 
* `dev_addr` Device address (7-bit address &lt;&lt; 1) 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_ReadReg 

_Reads a byte of data from the specified register._ 
```C++
EMC2305_Status EMC2305_ReadReg (
    EMC2305_HandleTypeDef * chip,
    uint8_t reg,
    uint8_t * data
) 
```





**Parameters:**


* `chip` EMC2305 handle 
* `reg` Register to read from 
* `data` Pointer where register data will be stored 



**Returns:**

OK if successful, ERR if message queue is full 





        

<hr>



### function EMC2305\_SetFanConfig 

_Sets the EMC2305 configuration 1 and 2 registers based on the provided config._ 
```C++
EMC2305_Status EMC2305_SetFanConfig (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan,
    EMC2305_Fan_Config1 * config1,
    EMC2305_Fan_Config2 * config2
) 
```





**Parameters:**


* `chip` EMC2305 to set 
* `fan` Fan to set (1-5) 
* `config1` Configuration for register 1 
* `config2` Configuration for register 2 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_SetFanPWM 

_Sets the PWM drive of the specified fan directly. Works only with fan speed control (FSC) disabled._ 
```C++
EMC2305_Status EMC2305_SetFanPWM (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan,
    uint8_t duty_cycle
) 
```





**Parameters:**


* `chip` EMC2305 to set 
* `fan` Fan to set (1-5) 
* `duty_cycle` PWM duty cycle percentage (0 to 100) 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_SetFanRPM 

_Sets the RPM target for the control algorithm. Works only with fan speed control (FSC) enabled._ 
```C++
EMC2305_Status EMC2305_SetFanRPM (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan,
    uint16_t rpm_target
) 
```





**Parameters:**


* `chip` EMC2305 to set 
* `fan` Fan to set (1-5) 
* `rpm_target` RPM target to set (500 to 16k) 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_SetGlobalConfig 

_Sets the EMC2305 global configuration register based on provided config._ 
```C++
EMC2305_Status EMC2305_SetGlobalConfig (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Global_Config * config
) 
```





**Parameters:**


* `chip` EMC2305 to configure 
* `config` Global configuration to use 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_SetPWMBaseFrequency 

_Sets the base frequency of the specified fan's PWM driver._ 
```C++
EMC2305_Status EMC2305_SetPWMBaseFrequency (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan,
    EMC2305_PWM_BaseFreq freq
) 
```





**Parameters:**


* `chip` EMC2305 to set 
* `fan` Fan to set (1-5) 
* `freq` Base frequency as specified in Section 6.10 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_SetPWMOutputMode 

_Sets the specified fan's PWM driver to open-drain or push-pull._ 
```C++
EMC2305_Status EMC2305_SetPWMOutputMode (
    EMC2305_HandleTypeDef * chip,
    EMC2305_Fan fan,
    bool open_drain
) 
```





**Parameters:**


* `chip` EMC2305 to set 
* `fan` Fan to set (1-5) 
* `open_drain` Set to true for open-drain (only driven low, requires pullup) or false for push-pull (driven high and low, no pullup) 



**Returns:**

OK if successful, ERR otherwise 





        

<hr>



### function EMC2305\_WriteReg 

_Writes a byte of data to the specified register._ 
```C++
EMC2305_Status EMC2305_WriteReg (
    EMC2305_HandleTypeDef * chip,
    uint8_t reg,
    uint8_t data
) 
```





**Parameters:**


* `chip` EMC2305 handle 
* `reg` Register to write to 
* `data` Data to write 



**Returns:**

OK if successful, ERR if message queue is full 





        

<hr>
## Macro Definition Documentation





### define EMC2305\_CFG\_DIS\_TO 

```C++
#define EMC2305_CFG_DIS_TO `(1u << 6)  /* DIS_TO - SMBus timeout disable (I2C compat) */`
```




<hr>



### define EMC2305\_CFG\_DRECK 

```C++
#define EMC2305_CFG_DRECK `(1u << 1)  /* DRECK - CLK pin drives internal clock when set (output) */`
```




<hr>



### define EMC2305\_CFG\_MASK\_ALERT 

```C++
#define EMC2305_CFG_MASK_ALERT `(1u << 7)  /* MASK - mask ALERT pin when set */`
```




<hr>



### define EMC2305\_CFG\_USECK 

```C++
#define EMC2305_CFG_USECK `(1u << 0)  /* USECK - use external CLK pin as tach clock when set */`
```




<hr>



### define EMC2305\_CFG\_WD\_EN 

```C++
#define EMC2305_CFG_WD_EN `(1u << 5)  /* WD_EN - enable watchdog continuous mode */`
```




<hr>



### define EMC2305\_CONFIG1\_EDG\_SHIFT 

```C++
#define EMC2305_CONFIG1_EDG_SHIFT `3u`
```




<hr>



### define EMC2305\_CONFIG1\_ENAG\_SHIFT 

```C++
#define EMC2305_CONFIG1_ENAG_SHIFT `7u`
```




<hr>



### define EMC2305\_CONFIG1\_RNG\_SHIFT 

```C++
#define EMC2305_CONFIG1_RNG_SHIFT `5u`
```




<hr>



### define EMC2305\_CONFIG1\_UDT\_SHIFT 

```C++
#define EMC2305_CONFIG1_UDT_SHIFT `0u`
```




<hr>



### define EMC2305\_CONFIG2\_DPT\_SHIFT 

```C++
#define EMC2305_CONFIG2_DPT_SHIFT `3u`
```




<hr>



### define EMC2305\_CONFIG2\_ENRC\_SHIFT 

```C++
#define EMC2305_CONFIG2_ENRC_SHIFT `6u`
```




<hr>



### define EMC2305\_CONFIG2\_ERG\_SHIFT 

```C++
#define EMC2305_CONFIG2_ERG_SHIFT `1u`
```




<hr>



### define EMC2305\_CONFIG2\_GHEN\_SHIFT 

```C++
#define EMC2305_CONFIG2_GHEN_SHIFT `5u`
```




<hr>



### define EMC2305\_FAN1\_MASK 

```C++
#define EMC2305_FAN1_MASK `(1u << 0)`
```




<hr>



### define EMC2305\_FAN2\_MASK 

```C++
#define EMC2305_FAN2_MASK `(1u << 1)`
```




<hr>



### define EMC2305\_FAN3\_MASK 

```C++
#define EMC2305_FAN3_MASK `(1u << 2)`
```




<hr>



### define EMC2305\_FAN4\_MASK 

```C++
#define EMC2305_FAN4_MASK `(1u << 3)`
```




<hr>



### define EMC2305\_FAN5\_MASK 

```C++
#define EMC2305_FAN5_MASK `(1u << 4)`
```




<hr>



### define EMC2305\_FAN\_ADDRESS\_OFFSET 

```C++
#define EMC2305_FAN_ADDRESS_OFFSET `0x10u`
```




<hr>



### define EMC2305\_FAN\_REG\_ADDR 

_Calculates the register address for a specific fan (N) based on the Fan 1 register address and known offset._ 
```C++
#define EMC2305_FAN_REG_ADDR (
    fan_num,
    fan1_reg_addr
) `((fan1_reg_addr) + ((fan_num) * EMC2305_FAN_ADDRESS_OFFSET ))`
```





**Parameters:**


* `fan_num` The fan number (0-4 to match fan enum). 
* `fan1_reg_addr` The address of the corresponding Fan 1 register (base) 



**Returns:**

The calculated register address for Fan N. 





        

<hr>



### define EMC2305\_I2C\_TIMEOUT 

```C++
#define EMC2305_I2C_TIMEOUT `100u`
```




<hr>



### define EMC2305\_INVALID\_FAN 

```C++
#define EMC2305_INVALID_FAN (
    fan_num
) `(fan < EMC2305_FAN1 || fan > EMC2305_FAN5 )`
```




<hr>



### define EMC2305\_MAX\_RPM 

```C++
#define EMC2305_MAX_RPM `16000`
```




<hr>



### define EMC2305\_MIN\_RPM 

```C++
#define EMC2305_MIN_RPM `500`
```




<hr>



### define EMC2305\_PWM\_FAN1\_MASK 

```C++
#define EMC2305_PWM_FAN1_MASK `0x03u`
```




<hr>



### define EMC2305\_PWM\_FAN1\_SHIFT 

```C++
#define EMC2305_PWM_FAN1_SHIFT `0u`
```




<hr>



### define EMC2305\_PWM\_FAN2\_MASK 

```C++
#define EMC2305_PWM_FAN2_MASK `0x0Cu`
```




<hr>



### define EMC2305\_PWM\_FAN2\_SHIFT 

```C++
#define EMC2305_PWM_FAN2_SHIFT `2u`
```




<hr>



### define EMC2305\_PWM\_FAN3\_MASK 

```C++
#define EMC2305_PWM_FAN3_MASK `0x30u`
```




<hr>



### define EMC2305\_PWM\_FAN3\_SHIFT 

```C++
#define EMC2305_PWM_FAN3_SHIFT `4u`
```




<hr>



### define EMC2305\_PWM\_FAN4\_MASK 

```C++
#define EMC2305_PWM_FAN4_MASK `0x03u`
```




<hr>



### define EMC2305\_PWM\_FAN4\_SHIFT 

```C++
#define EMC2305_PWM_FAN4_SHIFT `0u`
```




<hr>



### define EMC2305\_PWM\_FAN5\_MASK 

```C++
#define EMC2305_PWM_FAN5_MASK `0x0Cu`
```




<hr>



### define EMC2305\_PWM\_FAN5\_SHIFT 

```C++
#define EMC2305_PWM_FAN5_SHIFT `2u`
```




<hr>



### define EMC2305\_QUEUE\_ITEM\_SIZE 

```C++
#define EMC2305_QUEUE_ITEM_SIZE `sizeof( EMC2305_I2C_Message )`
```




<hr>



### define EMC2305\_QUEUE\_LENGTH 

```C++
#define EMC2305_QUEUE_LENGTH `10`
```




<hr>



### define EMC2305\_REG\_CONFIGURATION 

```C++
#define EMC2305_REG_CONFIGURATION `0x20u`
```




<hr>



### define EMC2305\_REG\_DRIVE\_FAIL\_STATUS 

```C++
#define EMC2305_REG_DRIVE_FAIL_STATUS `0x27u`
```




<hr>



### define EMC2305\_REG\_FAN1\_CONFIG1 

```C++
#define EMC2305_REG_FAN1_CONFIG1 `0x32u`
```




<hr>



### define EMC2305\_REG\_FAN1\_CONFIG2 

```C++
#define EMC2305_REG_FAN1_CONFIG2 `0x33u`
```




<hr>



### define EMC2305\_REG\_FAN1\_DRVFAIL\_H 

```C++
#define EMC2305_REG_FAN1_DRVFAIL_H `0x3Bu`
```




<hr>



### define EMC2305\_REG\_FAN1\_DRVFAIL\_L 

```C++
#define EMC2305_REG_FAN1_DRVFAIL_L `0x3Au`
```




<hr>



### define EMC2305\_REG\_FAN1\_MAX\_STEP 

```C++
#define EMC2305_REG_FAN1_MAX_STEP `0x37u`
```




<hr>



### define EMC2305\_REG\_FAN1\_MIN\_DRIVE 

```C++
#define EMC2305_REG_FAN1_MIN_DRIVE `0x38u`
```




<hr>



### define EMC2305\_REG\_FAN1\_SETTING 

```C++
#define EMC2305_REG_FAN1_SETTING `0x30u`
```




<hr>



### define EMC2305\_REG\_FAN1\_SPIN 

```C++
#define EMC2305_REG_FAN1_SPIN `0x36u`
```




<hr>



### define EMC2305\_REG\_FAN1\_TACH\_READING\_H 

```C++
#define EMC2305_REG_FAN1_TACH_READING_H `0x3Eu`
```




<hr>



### define EMC2305\_REG\_FAN1\_TACH\_READING\_L 

```C++
#define EMC2305_REG_FAN1_TACH_READING_L `0x3Fu`
```




<hr>



### define EMC2305\_REG\_FAN1\_TACH\_TARGET\_H 

```C++
#define EMC2305_REG_FAN1_TACH_TARGET_H `0x3Du`
```




<hr>



### define EMC2305\_REG\_FAN1\_TACH\_TARGET\_L 

```C++
#define EMC2305_REG_FAN1_TACH_TARGET_L `0x3Cu`
```




<hr>



### define EMC2305\_REG\_FAN1\_VALID\_TACH 

```C++
#define EMC2305_REG_FAN1_VALID_TACH `0x39u`
```




<hr>



### define EMC2305\_REG\_FAN\_INTERRUPT\_ENABLE 

```C++
#define EMC2305_REG_FAN_INTERRUPT_ENABLE `0x29u`
```




<hr>



### define EMC2305\_REG\_FAN\_SPIN\_STATUS 

```C++
#define EMC2305_REG_FAN_SPIN_STATUS `0x26u`
```




<hr>



### define EMC2305\_REG\_FAN\_STALL\_STATUS 

```C++
#define EMC2305_REG_FAN_STALL_STATUS `0x25u`
```




<hr>



### define EMC2305\_REG\_FAN\_STATUS 

```C++
#define EMC2305_REG_FAN_STATUS `0x24u`
```




<hr>



### define EMC2305\_REG\_GAIN1 

```C++
#define EMC2305_REG_GAIN1 `0x35u`
```




<hr>



### define EMC2305\_REG\_MANUFACTURER\_ID 

```C++
#define EMC2305_REG_MANUFACTURER_ID `0xFEu`
```




<hr>



### define EMC2305\_REG\_PRODUCT\_FEAT 

```C++
#define EMC2305_REG_PRODUCT_FEAT `0xFCu`
```




<hr>



### define EMC2305\_REG\_PRODUCT\_ID 

```C++
#define EMC2305_REG_PRODUCT_ID `0xFDu`
```




<hr>



### define EMC2305\_REG\_PWM1\_DIVIDE 

```C++
#define EMC2305_REG_PWM1_DIVIDE `0x31u`
```




<hr>



### define EMC2305\_REG\_PWM\_BASEF123 

```C++
#define EMC2305_REG_PWM_BASEF123 `0x2Du`
```




<hr>



### define EMC2305\_REG\_PWM\_BASEF45 

```C++
#define EMC2305_REG_PWM_BASEF45 `0x2Cu`
```




<hr>



### define EMC2305\_REG\_PWM\_OUTPUT\_CONFIG 

```C++
#define EMC2305_REG_PWM_OUTPUT_CONFIG `0x2Bu`
```




<hr>



### define EMC2305\_REG\_PWM\_POLARITY 

```C++
#define EMC2305_REG_PWM_POLARITY `0x2Au`
```




<hr>



### define EMC2305\_REG\_REVISION 

```C++
#define EMC2305_REG_REVISION `0xFFu`
```




<hr>



### define EMC2305\_REG\_SW\_LOCK 

```C++
#define EMC2305_REG_SW_LOCK `0xEFu`
```




<hr>



### define EMC2305\_SEMAPHORE\_POOL\_SIZE 

```C++
#define EMC2305_SEMAPHORE_POOL_SIZE `EMC2305_QUEUE_LENGTH`
```




<hr>



### define EMC2305\_STAT\_DRVFAIL 

```C++
#define EMC2305_STAT_DRVFAIL `(1u << 2)  /* Drive fail summary */`
```




<hr>



### define EMC2305\_STAT\_FNSPIN 

```C++
#define EMC2305_STAT_FNSPIN `(1u << 1)  /* spin-up failure summary */`
```




<hr>



### define EMC2305\_STAT\_FNSTL 

```C++
#define EMC2305_STAT_FNSTL `(1u << 0)  /* stall summary */`
```




<hr>



### define EMC2305\_STAT\_WATCH 

```C++
#define EMC2305_STAT_WATCH `(1u << 7)  /* WATCH - watchdog fired (read-to-clear) */`
```




<hr>



### define EMC2305\_SWL 

```C++
#define EMC2305_SWL `(1u << 0)`
```




<hr>



### define EMC2305\_TACH\_MULT 

```C++
#define EMC2305_TACH_MULT `2u`
```




<hr>



### define EMC2305\_TACH\_RPM\_CONV 

```C++
#define EMC2305_TACH_RPM_CONV `3932160u`
```




<hr>

------------------------------
The documentation for this class was generated from the following file `driver/Inc/EMC2305.h`

